/*! jsTmpl v1.0.1 | (c) Frank Chao | MIT license */
!function(r,q){"function"===typeof define&&define.amd?define(q):"object"===typeof module&&"object"===typeof module.exports?module.exports=q():r.jsTmpl=q()}(this,function(){var r=document;if(r.getElementsByTagName("head")[0].classList){var q=function(a,f){return f?f.querySelectorAll(a):r.querySelectorAll(a)},y=function(a,f){return f?f.querySelector(a):r.querySelector(a)},f={isArray:function(a){return!!Array.isArray(a)},optc:function(a){return Object.prototype.toString.call(a).replace(/(\[object |\])/g,"")},isString:function(a){return!("string"!==typeof a||"String"!==f.optc(a))},isPlainObj:function(a){return!("object"!==typeof a||"Object"!==f.optc(a)||"{}"===JSON.stringify(a))},format:function(a){a=a.replace(/(\{\{)\s+/g,"{{");return a=a.replace(/\s+(\}\})/g,"}}")},reg:function(a){return new RegExp("\\{\\{"+a+"\\}\\}","g")},ready:function(a){if("complete"===r.readyState)a();else var f=function(){r.addEventListener("DOMContentLoaded",function(){r.removeEventListener("DOMContentLoaded",f);a()})}()}},B=window.jsTmpl={tag:"js-tmpl",template:function(a,t){var C=arguments.length;f.ready(function(){if(2==C&&f.isString(a)&&f.isPlainObj(t)){var m=y(a),u=Date.now(),h=q("*",m),k="";if(m){for(var d=0,g=h.length;d<g;d++){var c=h[d];"true"==c.getAttribute("js-one")&&(k="jsTmpl-"+u+parseInt(1E17*Math.random()),c.classList.add(k),c.classList.add("jsTmpl-"+u))}var e=m.innerHTML;m.innerHTML="\x3c!--  --\x3e";d=e.match(/{{/g);g=e.match(/}}/g);d=d?d.length:0;g=g?g.length:0;if(0!=d&&0!=g&&d==g){var k=e=f.format(e),g="",v,h=t.one&&f.isPlainObj(t.one)?t.one:void 0,c=(v=t.set&&f.isArray(t.set)?t.set:void 0)?v.length:0;if(0<c)for(var n=0,d=0;d<c;d++)(function(a){a=v[a];if(f.isPlainObj(a))for(var b in a)e=e.replace(f.reg(b),a[b]);if(-1<e.indexOf("$index"))if(n++,-1<e.indexOf("$index(")){if(b=parseInt(e.match(/\$index\((\S*)\)/)[1]),0<=b)switch(b){case 0:e=e.replace("{{$index(0)}}",n-1);break;case 1:e=e.replace("{{$index(1)}}",n);break;default:e=e.replace(new RegExp("\\{\\{\\$index\\("+b+"\\)\\}\\}","g"),n+b-1)}}else e=e.replace("{{$index}}",n);e=-1<e.indexOf("$total")?e.replace("{{$total}}",v.length):e})(d),g+=e,e=k;if(h)for(var b in h)d=f.reg(b),g=""!=g?g.replace(d,h[b]):e.replace(d,h[b]);d='\x3csection id\x3d"jsTmpl-'+u+'" style\x3d"display:none;"\x3e'+g+"\x3c/section\x3e";y("body").insertAdjacentHTML("beforeend",d);b=r.getElementById("jsTmpl-"+u);for(var h=q(".jsTmpl-"+u,b),p=[],d=0,g=h.length;d<g;d++)k=h[d],c=k.className.replace(/\s+/g," ").split(" "),k.removeAttribute("js-one"),c.forEach(function(a){a.match("jsTmpl-")&&24<a.length&&-1==p.indexOf(a)&&p.push(a)});p.forEach(function(a){var b=y("."+a);b.classList.remove(a);b.classList.remove("jsTmpl-"+u);""==b.className&&b.removeAttribute("class");a=q("."+a);for(b=a.length-1;0<=b;b--)a[b].parentNode.removeChild(a[b])});g=b.innerHTML;b.parentNode.removeChild(b);m.innerHTML=g}}}})},component:function(a){if(1==arguments.length&&f.isPlainObj(a)){var t=a.name,C=a.template,m=a.data,u=a.events,h=a.check;if(5>=Object.keys(a).length&&t&&C&&m&&f.isString(t)&&f.isString(C)&&f.isPlainObj(m)){var k=B.tag;f.ready(function(){for(var a=y("body"),g=q(k),c=g.length-1;0<=c;c--)(function(b){b=g[b];var p=b.getAttribute("name"),e=b.getAttribute("target");b.innerHTML="";if(p==t){a.insertAdjacentHTML("beforeend",'\x3csection id\x3d"jstmpl-virtual-section" style\x3d"display:none;"\x3e\x3c/section\x3e');p=r.getElementById("jstmpl-virtual-section");p.innerHTML=C;for(var d=q("*",p),c=0,h=d.length;c<h;c++){var w=d[c];w.getAttribute("js-data")&&w.classList.add("jstmpl-doing-for");w.getAttribute("js-event")&&w.classList.add("jstmpl-add-event");w.getAttribute("js-if")&&w.classList.add("jstmpl-check-if")}c=p.innerHTML;c=f.format(c);p.innerHTML=c;d=q(".jstmpl-doing-for",p);h=0;if(0<d.length)for(c=d.length-1;0<=c;c--){var w=d[c],l=w.outerHTML,k=w.getAttribute("js-data"),k=m[e][k],u=l,v="";if(f.isArray(k)){for(var h=k.length,n=0,y=0,B=k.length;y<B;y++){var z=k[y],l=u,x;for(x in z)l=l.replace(f.reg(x),z[x]);if(-1<l.indexOf("$index"))if(n++,-1<l.indexOf("$index(")){if(z=parseInt(l.match(/\$index\((\S*)\)/)[1]),0<=z)switch(z){case 0:var A=/\{\{\$index\(0\)\}\}/g,l=l.replace(A,n-1);break;case 1:A=/\{\{\$index\(1\)\}\}/g;l=l.replace(A,n);break;default:A=new RegExp("\\{\\{\\$index\\("+z+"\\)\\}\\}","g"),l=l.replace(A,n+z-1)}}else A=/\{\{\$index\}\}/g,l=l.replace(A,n);v+=l}w.insertAdjacentHTML("afterend",v);w.parentNode.removeChild(w)}}x=p.innerHTML.replace("{{$total}}",h);for(var D in m[e])x=x.replace(f.reg(D),m[e][D]);b.outerHTML=x;p.parentNode&&p.parentNode.removeChild(p);D=q(".jstmpl-doing-for",a);b=0;for(e=D.length;b<e;b++)x=D[b],x.classList.remove("jstmpl-doing-for"),""==x.className&&x.removeAttribute("class")}})(c);var e=q(".jstmpl-add-event",a),v=e.length;if(0<v)for(c=0;c<v;c++)(function(a){var b=e[a];a=b.getAttribute("js-event");var c=a.substring(0,a.indexOf(":")),d=a.substring(a.indexOf(":")+1);b.classList.remove("jstmpl-add-event");""==b.className&&b.removeAttribute("class");b.addEventListener(c,function(){u[d].apply(b)})})(c);var n=q(".jstmpl-check-if",a);if(0<n.length)for(c=0,v=n.length;c<v;c++)(function(a){a=n[a];var b=a.getAttribute("js-if"),c=b.substring(0,b.indexOf(":")),b=b.substring(b.indexOf(":")+1);a.classList.remove("jstmpl-check-if");""==a.className&&a.removeAttribute("class");h[c].apply(a,[b])})(c)})}}},replace:function(a){1==arguments.length&&f.isPlainObj(a)&&f.ready(function(){for(var t=f.format(a.template),r=q(B.tag),m=0,u=r.length;m<u;m++){var h=r[m];if(!h.getAttribute("target")){for(var k=h.outerHTML.split(/(=|\s+)/).filter(function(a){return a&&!a.match(/(\<|\>|\=|\s+|\"|\'|name|target)/)}),d=t,g="";-1<d.indexOf("{{");)k.forEach(function(a){d=g=d.replace(f.reg(a),h.getAttribute(a))});h.outerHTML=g}}})}};Object.freeze(B)}else throw Error("jsTmpl's Javascript does not support of ie9- !!!");return B});
