/*! jsTmpl v1.0.0 | (c) Frank Chao | MIT license */
!function(r,q){"function"===typeof define&&define.amd?define(q):"object"===typeof module&&"object"===typeof module.exports?module.exports=q():r.jsTmpl=q()}(this,function(){var r=document;if(r.getElementsByTagName("head")[0].classList){var q=function(a,d){return d?d.querySelectorAll(a):r.querySelectorAll(a)},y=function(a,d){return d?d.querySelector(a):r.querySelector(a)},d={isArray:function(a){return!!Array.isArray(a)},optc:function(a){return Object.prototype.toString.call(a).replace(/(\[object |\])/g,"")},isString:function(a){return!("string"!==typeof a||"String"!==d.optc(a))},isPlainObj:function(a){return!("object"!==typeof a||"Object"!==d.optc(a)||"{}"===JSON.stringify(a))},format:function(a){a=a.replace(/(\{\{)\s+/g,"{{");return a=a.replace(/\s+(\}\})/g,"}}")},reg:function(a){return new RegExp("\\{\\{"+a+"\\}\\}","g")},ready:function(a){if("complete"===r.readyState)a();else var d=function(){r.addEventListener("DOMContentLoaded",function(){r.removeEventListener("DOMContentLoaded",d);a()})}()}},B=window.jsTmpl={tag:"js-tmpl",template:function(a,t){var C=arguments.length;d.ready(function(){if(2==C&&d.isString(a)&&d.isPlainObj(t)){var m=y(a),u=Date.now(),h=q("*",m),k="";if(m){for(var e=0,g=h.length;e<g;e++){var f=h[e];"true"==f.getAttribute("js-one")&&(k="jsTmpl-"+u+parseInt(1E17*Math.random()),f.classList.add(k),f.classList.add("jsTmpl-"+u))}var c=m.innerHTML;m.innerHTML="\x3c!--  --\x3e";e=c.match(/{{/g);g=c.match(/}}/g);e=e?e.length:0;g=g?g.length:0;if(0!=e&&0!=g&&e==g){var k=c=d.format(c),g="",v,h=t.one&&d.isPlainObj(t.one)?t.one:void 0,f=(v=t.set&&d.isArray(t.set)?t.set:void 0)?v.length:0;if(0<f)for(var n=0,e=0;e<f;e++)(function(a){a=v[a];if(d.isPlainObj(a))for(var b in a)c=c.replace(d.reg(b),a[b]);if(-1<c.indexOf("$index"))if(n++,-1<c.indexOf("$index(")){if(b=parseInt(c.match(/\$index\((\S*)\)/)[1]),0<=b)switch(b){case 0:c=c.replace("{{$index(0)}}",n-1);break;case 1:c=c.replace("{{$index(1)}}",n);break;default:c=c.replace(new RegExp("\\{\\{\\$index\\("+b+"\\)\\}\\}","g"),n+b-1)}}else c=c.replace("{{$index}}",n);c=-1<c.indexOf("$total")&&c.replace("{{$total}}",v.length)})(e),g+=c,c=k;if(h)for(var b in h)e=d.reg(b),g=""!=g?g.replace(e,h[b]):c.replace(e,h[b]);e='\x3csection id\x3d"jsTmpl-'+u+'" style\x3d"display:none;"\x3e'+g+"\x3c/section\x3e";y("body").insertAdjacentHTML("beforeend",e);b=r.getElementById("jsTmpl-"+u);for(var h=q(".jsTmpl-"+u,b),p=[],e=0,g=h.length;e<g;e++)k=h[e],f=k.className.replace(/\s+/g," ").split(" "),k.removeAttribute("js-one"),f.forEach(function(a){a.match("jsTmpl-")&&24<a.length&&-1==p.indexOf(a)&&p.push(a)});p.forEach(function(a){var b=y("."+a);b.classList.remove(a);b.classList.remove("jsTmpl-"+u);""==b.className&&b.removeAttribute("class");a=q("."+a);for(b=a.length-1;0<=b;b--)a[b].parentNode.removeChild(a[b])});g=b.innerHTML;b.parentNode.removeChild(b);m.innerHTML=g}}}})},component:function(a){if(1==arguments.length&&d.isPlainObj(a)){var t=a.name,C=a.template,m=a.data,u=a.events,h=a.check;if(5>=Object.keys(a).length&&t&&C&&m&&d.isString(t)&&d.isString(C)&&d.isPlainObj(m)){var k=B.tag;d.ready(function(){for(var a=y("body"),g=q(k),f=g.length-1;0<=f;f--)(function(b){b=g[b];var p=b.getAttribute("name"),e=b.getAttribute("target");b.innerHTML="";if(p==t){a.insertAdjacentHTML("beforeend",'\x3csection id\x3d"jstmpl-virtual-section" style\x3d"display:none;"\x3e\x3c/section\x3e');p=r.getElementById("jstmpl-virtual-section");p.innerHTML=C;for(var f=q("*",p),c=0,h=f.length;c<h;c++){var w=f[c];w.getAttribute("js-data")&&w.classList.add("jstmpl-doing-for");w.getAttribute("js-event")&&w.classList.add("jstmpl-add-event");w.getAttribute("js-if")&&w.classList.add("jstmpl-check-if")}c=p.innerHTML;c=d.format(c);p.innerHTML=c;f=q(".jstmpl-doing-for",p);h=0;if(0<f.length)for(c=f.length-1;0<=c;c--){var w=f[c],l=w.outerHTML,k=w.getAttribute("js-data"),k=m[e][k],u=l,v="";if(d.isArray(k)){for(var h=k.length,n=0,y=0,B=k.length;y<B;y++){var z=k[y],l=u,x;for(x in z)l=l.replace(d.reg(x),z[x]);if(-1<l.indexOf("$index"))if(n++,-1<l.indexOf("$index(")){if(z=parseInt(l.match(/\$index\((\S*)\)/)[1]),0<=z)switch(z){case 0:var A=/\{\{\$index\(0\)\}\}/g,l=l.replace(A,n-1);break;case 1:A=/\{\{\$index\(1\)\}\}/g;l=l.replace(A,n);break;default:A=new RegExp("\\{\\{\\$index\\("+z+"\\)\\}\\}","g"),l=l.replace(A,n+z-1)}}else A=/\{\{\$index\}\}/g,l=l.replace(A,n);v+=l}w.insertAdjacentHTML("afterend",v);w.parentNode.removeChild(w)}}x=p.innerHTML.replace("{{$total}}",h);for(var D in m[e])x=x.replace(d.reg(D),m[e][D]);b.outerHTML=x;p.parentNode&&p.parentNode.removeChild(p);D=q(".jstmpl-doing-for",a);b=0;for(e=D.length;b<e;b++)x=D[b],x.classList.remove("jstmpl-doing-for"),""==x.className&&x.removeAttribute("class")}})(f);var c=q(".jstmpl-add-event",a),v=c.length;if(0<v)for(f=0;f<v;f++)(function(a){var b=c[a];a=b.getAttribute("js-event");var f=a.substring(0,a.indexOf(":")),d=a.substring(a.indexOf(":")+1);b.classList.remove("jstmpl-add-event");""==b.className&&b.removeAttribute("class");b.addEventListener(f,function(){u[d].apply(b)})})(f);var n=q(".jstmpl-check-if",a);if(0<n.length)for(f=0,v=n.length;f<v;f++)(function(a){a=n[a];var b=a.getAttribute("js-if"),c=b.substring(0,b.indexOf(":")),b=b.substring(b.indexOf(":")+1);a.classList.remove("jstmpl-check-if");""==a.className&&a.removeAttribute("class");h[c].apply(a,[b])})(f)})}}},replace:function(a){1==arguments.length&&d.isPlainObj(a)&&d.ready(function(){for(var t=d.format(a.template),r=q(B.tag),m=0,u=r.length;m<u;m++){var h=r[m];if(!h.getAttribute("target")){for(var k=h.outerHTML.split(/(=|\s+)/).filter(function(a){return a&&!a.match(/(\<|\>|\=|\s+|\"|\'|name|target)/)}),e=t,g="";-1<e.indexOf("{{");)k.forEach(function(a){e=g=e.replace(d.reg(a),h.getAttribute(a))});h.outerHTML=g}}})}};Object.freeze(B)}else throw Error("jsTmpl's Javascript does not support of ie9- !!!");return B});
